# BUILD PHASE
FROM node:alpine as builder
WORKDIR '/app'

# GET ARGS
ARG PORT
ARG REACT_APP_TELEGRAM_BOT_URL
ARG REACT_APP_API_BASE_URL
ARG REACT_APP_GITHUB_REPO_URL
ARG REACT_APP_GITHUB_REDIRECT_URL
ARG REACT_APP_GITHUB_AUTHORIZE
ARG REACT_APP_GITHUB_CLIENT_ID
ARG REACT_APP_GITHUB_SCOPE
# ANDS EXPORT THEN
ENV PORT=${PORT}
ENV REACT_APP_TELEGRAM_BOT_URL=${REACT_APP_TELEGRAM_BOT_URL}
ENV REACT_APP_API_BASE_URL=${REACT_APP_API_BASE_URL}
ENV REACT_APP_GITHUB_REPO_URL=${REACT_APP_GITHUB_REPO_URL}
ENV REACT_APP_GITHUB_REDIRECT_URL=${REACT_APP_GITHUB_REDIRECT_URL}
ENV REACT_APP_GITHUB_AUTHORIZE=${REACT_APP_GITHUB_AUTHORIZE}
ENV REACT_APP_GITHUB_CLIENT_ID=${REACT_APP_GITHUB_CLIENT_ID}
ENV REACT_APP_GITHUB_SCOPE=${REACT_APP_GITHUB_SCOPE}

COPY package.json .
RUN yarn
COPY . .
RUN yarn cache clean
