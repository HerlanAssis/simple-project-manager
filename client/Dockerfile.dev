# BUILD PHASE
FROM node:alpine as builder
WORKDIR '/app'

# GET ARGS
ARG PORT
ARG REACT_APP_TELEGRAM_BOT_URL
ARG REACT_APP_API_BASE_URL
ARG REACT_APP_GOOGLE_REDIRECT_URL
ARG REACT_APP_GOOGLE_AUTHORIZE
ARG REACT_APP_GOOGLE_CLIENT_ID
ARG REACT_APP_GOOGLE_SCOPE
# AND EXPORT THEN
ENV PORT=${PORT}
ENV REACT_APP_TELEGRAM_BOT_URL=${REACT_APP_TELEGRAM_BOT_URL}
ENV REACT_APP_API_BASE_URL=${REACT_APP_API_BASE_URL}
ENV REACT_APP_GOOGLE_REDIRECT_URL=${REACT_APP_GOOGLE_REDIRECT_URL}
ENV REACT_APP_GOOGLE_AUTHORIZE=${REACT_APP_GOOGLE_AUTHORIZE}
ENV REACT_APP_GOOGLE_CLIENT_ID=${REACT_APP_GOOGLE_CLIENT_ID}
ENV REACT_APP_GOOGLE_SCOPE=${REACT_APP_GOOGLE_SCOPE}

COPY package.json .
RUN yarn
COPY . .
RUN yarn cache clean
